package com.org.readingData;

import org.testng.annotations.DataProvider;
import org.testng.annotations.Test;

public class TestData {

	 Xls_Reader xls = new Xls_Reader("C:/MyWorkSpace/DesignePattern/readingData/Data.xlsx");
	 String sheetName  = "sheet";
	  String testcaseName = "TestA";
		
	@Test
	public void testA(){
		
	}
	
	@DataProvider
	public Object[][] getData(){
		

	       //Xls_Reader xls = new Xls_Reader("C:/MyWorkSpace/DesignePattern/readingData/Data.xlsx");
	       	//System.out.println("Start Row: "+ testStartRowNum);
			int colStartRowNum = getTestStartRowNum(xls,sheetName) + 1; //
			int dataStartRowNum = getTestStartRowNum(xls,sheetName) + 2;
			
			/*
			 * The below code is to get total number of Rows for a test
			 */
			
			/*
			 * The below code is to get total number of columns for a test 
			 */

			/*
			 * Gets all the Data for test case 
			 */
			
			for(int rNum=dataStartRowNum;rNum<dataStartRowNum+totDataRows;rNum++){
				for(int cNum=0; cNum<totDataCol;cNum++){
					System.out.print(xls.getCellData(sheetName, cNum, rNum)+" ");
				}
				System.out.println();
			}
			
	    
		
		return null;
	}
	

	
	/**
	 * Gives the Rown Number from where the test starts
	 * @param xls
	 * @param sheetName
	 * @return
	 */
	public int getTestStartRowNum(Xls_Reader xls, String sheetName){
		int testStartRowNum = 1;
		while(!xls.getCellData(sheetName, 0, testStartRowNum).equals(testcaseName)){
			testStartRowNum ++;
		}
		return testStartRowNum+2;
	}
	
	public int getTestStartColumnNum(Xls_Reader xls, String sheetName){
		int testStartRowNum = 1;
		while(!xls.getCellData(sheetName, 0, testStartRowNum).equals(testcaseName)){
			testStartRowNum ++;
		}
		return testStartRowNum+1;
	}
	
	/**
	 * Gives the total number of rows for the test
	 * @param xls
	 * @param sheetName
	 * @return
	 */
	public int getTotTestRows(Xls_Reader xls, String sheetName){
		int totDataRows = 0;		
		while(!xls.getCellData(sheetName, 0, getTestStartRowNum(xls,sheetName)+totDataRows).equals("")){
			totDataRows++;
		}
		System.out.println("Total Data Rows for "+ testcaseName + ": "+ totDataRows);
		return totDataRows;
	}
	
	
	public int getTotalTestCaseColumns(Xls_Reader xls, String sheetName){
		int totDataCol = 0;
		while(!xls.getCellData(sheetName, totDataCol, colStartRowNum).equals("")){
			totDataCol++;
		}
		System.out.println("Total data Columns for testcase : "+testcaseName + " "+ totDataCol);
		
		return 0;
	}
	
	public int getTotalTestCaseDataRows(Xls_Reader xls, String sheetName){
		return 0;
	}
	public int getTotalTestCaseDataColumns(Xls_Reader xls, String sheetName){
		return 0;
	}
	
}
